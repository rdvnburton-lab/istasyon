<div class="grid grid-cols-12 gap-6">
    <!-- Başlık -->
    <div class="col-span-12">
        <div class="card">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                <div>
                    <h2 class="text-2xl font-bold text-surface-800 dark:text-surface-100 m-0">
                        <i class="pi pi-chart-bar mr-2 text-blue-500"></i>Vardiya Raporu
                    </h2>
                    <p class="text-surface-500 mt-2">
                        İstasyonunuzun vardiya bazlı performans özeti
                    </p>
                </div>
                <div *ngIf="userRole === 'admin' || userRole === 'patron' || userRole === 'istasyon_sorumlusu'">
                    <p-selectButton [options]="raporTurleri" [(ngModel)]="raporTuru" (onChange)="raporla()"
                        optionLabel="label" optionValue="value">
                        <ng-template let-item pTemplate="item">
                            <div class="flex items-center gap-2 px-2">
                                <i [class]="item.icon"></i>
                                <span>{{item.label}}</span>
                            </div>
                        </ng-template>
                    </p-selectButton>
                </div>
            </div>
        </div>
    </div>

    <!-- Filtreler -->
    <div class="col-span-12">
        <div class="card">
            <div class="flex flex-col md:flex-row gap-4 items-end">
                <div class="flex-1 grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="flex flex-col gap-2">
                        <label class="font-bold text-sm text-surface-700 dark:text-surface-200">Başlangıç Tarihi</label>
                        <p-datePicker [(ngModel)]="baslangicTarihi" dateFormat="dd.mm.yy" [showIcon]="true"
                            inputId="baslangic" styleClass="w-full"></p-datePicker>
                    </div>
                    <div class="flex flex-col gap-2">
                        <label class="font-bold text-sm text-surface-700 dark:text-surface-200">Bitiş Tarihi</label>
                        <p-datePicker [(ngModel)]="bitisTarihi" dateFormat="dd.mm.yy" [showIcon]="true" inputId="bitis"
                            styleClass="w-full"></p-datePicker>
                    </div>
                </div>
                <div class="flex gap-2">
                    <p-button label="Bugün" [text]="true" size="small" (onClick)="tarihAyarla('bugun')"></p-button>
                    <p-button label="Dün" [text]="true" size="small" (onClick)="tarihAyarla('dun')"></p-button>
                    <p-button label="Bu Ay" [text]="true" size="small" (onClick)="tarihAyarla('buAy')"></p-button>
                    <p-button label="Raporla" icon="pi pi-search" (onClick)="raporla()" severity="primary"></p-button>
                </div>
            </div>
        </div>
    </div>

    <!-- Pompa Özeti -->
    <div *ngIf="raporTuru === 'pompa'" class="col-span-12">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
            <div class="card mb-0 h-full bg-blue-50 dark:bg-blue-900/10 border-none shadow-none">
                <div class="text-blue-600 dark:text-blue-400 font-medium mb-2">Toplam Vardiya</div>
                <div class="text-2xl font-bold text-blue-900 dark:text-blue-100">{{ozet.toplamVardiya}}</div>
            </div>
            <div class="card mb-0 h-full bg-green-50 dark:bg-green-900/10 border-none shadow-none">
                <div class="text-green-600 dark:text-green-400 font-medium mb-2">Toplam Ciro</div>
                <div class="text-2xl font-bold text-green-900 dark:text-green-100">{{ozet.toplamTutar |
                    currency:'TRY':'symbol-narrow':'1.2-2'}}</div>
            </div>
            <div class="card mb-0 h-full bg-orange-50 dark:bg-orange-900/10 border-none shadow-none">
                <div class="text-orange-600 dark:text-orange-400 font-medium mb-2">Toplam Litre</div>
                <div class="text-2xl font-bold text-orange-900 dark:text-orange-100">{{ozet.toplamLitre |
                    number:'1.2-2'}}
                    Lt</div>
            </div>
            <div class="card mb-0 h-full bg-purple-50 dark:bg-purple-900/10 border-none shadow-none">
                <div class="text-purple-600 dark:text-purple-400 font-medium mb-2">Toplam Gider</div>
                <div class="text-2xl font-bold text-purple-900 dark:text-purple-100">{{ozet.toplamGider |
                    currency:'TRY':'symbol-narrow':'1.2-2'}}</div>
            </div>
        </div>
    </div>

    <!-- Market Özeti -->
    <div *ngIf="raporTuru === 'market'" class="col-span-12">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
            <div class="card mb-0 h-full bg-blue-50 dark:bg-blue-900/10 border-none shadow-none">
                <div class="text-blue-600 dark:text-blue-400 font-medium mb-2">Toplam Vardiya</div>
                <div class="text-2xl font-bold text-blue-900 dark:text-blue-100">{{ozet.toplamVardiya}}</div>
            </div>
            <div class="card mb-0 h-full bg-green-50 dark:bg-green-900/10 border-none shadow-none">
                <div class="text-green-600 dark:text-green-400 font-medium mb-2">Toplam Satış</div>
                <div class="text-2xl font-bold text-green-900 dark:text-green-100">{{ozet.toplamSatis |
                    currency:'TRY':'symbol-narrow':'1.2-2'}}</div>
            </div>
            <div class="card mb-0 h-full bg-indigo-50 dark:bg-indigo-900/10 border-none shadow-none">
                <div class="text-indigo-600 dark:text-indigo-400 font-medium mb-2">Toplam Teslimat</div>
                <div class="text-2xl font-bold text-indigo-900 dark:text-indigo-100">{{ozet.toplamTeslimat |
                    currency:'TRY':'symbol-narrow':'1.2-2'}}</div>
            </div>
            <div class="card mb-0 h-full"
                [ngClass]="ozet.toplamFark < 0 ? 'bg-red-50 dark:bg-red-900/10' : 'bg-teal-50 dark:bg-teal-900/10'">
                <div
                    [class]="ozet.toplamFark < 0 ? 'text-red-600 dark:text-red-400 font-medium mb-2' : 'text-teal-600 dark:text-teal-400 font-medium mb-2'">
                    Toplam Fark</div>
                <div
                    [class]="ozet.toplamFark < 0 ? 'text-2xl font-bold text-red-900 dark:text-red-100' : 'text-2xl font-bold text-teal-900 dark:text-teal-100'">
                    {{ozet.toplamFark | currency:'TRY':'symbol-narrow':'1.2-2'}}</div>
            </div>
        </div>
    </div>

    <!-- Tablo -->
    <div class="col-span-12">
        <div class="card">
            <p-table [value]="vardiyalar" [paginator]="true" [rows]="10" [loading]="loading"
                styleClass="p-datatable-striped" [rowHover]="true">
                <ng-template pTemplate="caption">
                    <div class="flex justify-between items-center">
                        <span class="text-xl font-bold">Vardiya Listesi ({{ vardiyalar.length }})</span>
                    </div>
                </ng-template>
                <ng-template pTemplate="header">
                    <tr *ngIf="raporTuru === 'pompa'" class="text-sm">
                        <th>Tarih</th>
                        <th>Dosya Adı</th>
                        <th class="text-right">Tutar</th>
                        <th class="text-center">Durum</th>
                    </tr>
                    <tr *ngIf="raporTuru === 'market'" class="text-sm">
                        <th>Tarih</th>
                        <th class="text-right">Satış Tutarı</th>
                        <th class="text-right">Teslimat Tutarı</th>
                        <th class="text-right">Fark</th>
                        <th class="text-center">Durum</th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-vardiya>
                    <tr *ngIf="raporTuru === 'pompa'"
                        class="hover:bg-surface-50 dark:hover:bg-surface-800 transition-colors">
                        <td><span class="text-surface-800 dark:text-surface-100 font-medium">{{vardiya.tarih |
                                date:'dd.MM.yyyy HH:mm'}}</span></td>
                        <td>{{vardiya.dosyaAdi}}</td>
                        <td class="text-right font-bold text-surface-800 dark:text-surface-100">{{vardiya.tutar |
                            currency:'TRY':'symbol-narrow':'1.2-2'}}</td>
                        <td class="text-center">
                            <p-tag [value]="vardiya.durum"
                                [severity]="vardiya.durum === 'ONAYLANDI' ? 'success' : vardiya.durum === 'ACIK' ? 'info' : vardiya.durum === 'REDDEDILDI' ? 'danger' : 'warn'"></p-tag>
                        </td>
                    </tr>
                    <tr *ngIf="raporTuru === 'market'"
                        class="hover:bg-surface-50 dark:hover:bg-surface-800 transition-colors">
                        <td><span class="text-surface-800 dark:text-surface-100 font-medium">{{vardiya.tarih |
                                date:'dd.MM.yyyy'}}</span></td>
                        <td class="text-right font-bold text-surface-800 dark:text-surface-100">
                            {{vardiya.toplamSatisTutari | currency:'TRY':'symbol-narrow':'1.2-2'}}
                        </td>
                        <td class="text-right font-bold text-blue-600">{{vardiya.toplamTeslimatTutari |
                            currency:'TRY':'symbol-narrow':'1.2-2'}}</td>
                        <td class="text-right font-bold" [class.text-red-600]="vardiya.toplamFark < 0"
                            [class.text-green-600]="vardiya.toplamFark >= 0">
                            {{vardiya.toplamFark | currency:'TRY':'symbol-narrow':'1.2-2'}}
                        </td>
                        <td class="text-center">
                            <p-tag [value]="vardiya.durum"
                                [severity]="vardiya.durum === 'ONAYLANDI' ? 'success' : vardiya.durum === 'ACIK' ? 'info' : vardiya.durum === 'REDDEDILDI' ? 'danger' : 'warn'"></p-tag>
                        </td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                    <tr>
                        <td [attr.colspan]="raporTuru === 'pompa' ? 4 : 5" class="text-center p-4">Bu tarih aralığında
                            kayıt bulunamadı.</td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
    </div>
</div>