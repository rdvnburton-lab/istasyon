<div class="card">
    <div class="flex justify-between items-center mb-6">
        <div>
            <h2 class="text-3xl font-bold m-0">Vardiya İşlem Geçmişi</h2>
            <p class="text-surface-500 mt-2">Tüm vardiya işlemlerinin detaylı kaydı</p>
        </div>
        <p-button icon="pi pi-refresh" label="Yenile" [text]="true" (onClick)="loglariYukle()"></p-button>
    </div>

    <p-table [value]="loglar" [loading]="loading" [paginator]="true" [rows]="20"
        [rowsPerPageOptions]="[10, 20, 50, 100]" [tableStyle]="{ 'min-width': '70rem' }"
        styleClass="p-datatable-sm p-datatable-striped">
        <ng-template pTemplate="header">
            <tr>
                <th style="width: 80px">ID</th>
                <th>Vardiya</th>
                <th>İstasyon</th>
                <th style="width: 180px">İşlem</th>
                <th>Açıklama</th>
                <th style="width: 150px">Kullanıcı</th>
                <th style="width: 100px">Rol</th>
                <th style="width: 120px">Durum Değişimi</th>
                <th style="width: 180px">Tarih</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-log>
            <tr>
                <td><span class="text-muted-color">#</span>{{ log.vardiyaId }}</td>
                <td>
                    <div class="flex items-center gap-2">
                        <i class="pi pi-file text-primary"></i>
                        <span class="font-medium">{{ log.vardiyaDosyaAdi }}</span>
                    </div>
                </td>
                <td>
                    <span class="text-sm">{{ log.istasyonAdi }}</span>
                </td>
                <td>
                    <p-tag [value]="getIslemLabel(log.islem)" [severity]="getIslemSeverity(log.islem)"
                        [icon]="getIslemIcon(log.islem)" styleClass="text-sm px-3 py-1">
                    </p-tag>
                </td>
                <td>
                    <span class="text-sm text-surface-600 dark:text-surface-300" [pTooltip]="log.aciklama"
                        tooltipPosition="top" *ngIf="log.aciklama">
                        {{ log.aciklama.length > 50 ? (log.aciklama | slice:0:50) + '...' : log.aciklama }}
                    </span>
                    <span class="text-surface-400" *ngIf="!log.aciklama">-</span>
                </td>
                <td>
                    <div class="flex items-center gap-2" *ngIf="log.kullaniciAdi">
                        <i class="pi pi-user text-xs text-surface-400"></i>
                        <span class="text-sm font-medium">{{ log.kullaniciAdi }}</span>
                    </div>
                    <span class="text-surface-400" *ngIf="!log.kullaniciAdi">-</span>
                </td>
                <td>
                    <p-tag [value]="log.kullaniciRol || '-'"
                        [severity]="log.kullaniciRol === 'admin' ? 'danger' : log.kullaniciRol === 'patron' ? 'warn' : 'info'"
                        styleClass="text-xs" *ngIf="log.kullaniciRol">
                    </p-tag>
                    <span class="text-surface-400" *ngIf="!log.kullaniciRol">-</span>
                </td>
                <td>
                    <div class="flex items-center gap-1 text-xs" *ngIf="log.eskiDurum && log.yeniDurum">
                        <span class="text-surface-500">{{ log.eskiDurum }}</span>
                        <i class="pi pi-arrow-right text-surface-400"></i>
                        <span class="text-primary font-medium">{{ log.yeniDurum }}</span>
                    </div>
                    <span class="text-surface-400" *ngIf="!log.eskiDurum || !log.yeniDurum">-</span>
                </td>
                <td>
                    <div class="flex flex-col">
                        <span class="text-sm font-medium">{{ log.islemTarihi | date:'dd.MM.yyyy' }}</span>
                        <span class="text-xs text-surface-500">{{ log.islemTarihi | date:'HH:mm:ss' }}</span>
                    </div>
                </td>
            </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage">
            <tr>
                <td colspan="9" class="text-center p-8">
                    <div class="flex flex-col items-center gap-4 text-muted-color opacity-60">
                        <i class="pi pi-history text-6xl"></i>
                        <span class="font-medium text-xl">Henüz işlem kaydı bulunmuyor</span>
                    </div>
                </td>
            </tr>
        </ng-template>
    </p-table>
</div>